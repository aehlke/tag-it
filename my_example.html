<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title></title>
    <!-- These 2 CSS files are required: any 1 jQuery UI theme CSS, plus the Tag-it base CSS. -->
    <link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1/themes/flick/jquery-ui.css">
    <link rel="stylesheet" type="text/css" href="css/jquery.tagit.css">

    <!-- This is an optional CSS theme that only applies to this widget. Use it in addition to the jQuery UI theme. -->
    <link href="css/tagit.ui-zendesk.css" rel="stylesheet" type="text/css">

    <!-- jQuery and jQuery UI are required dependencies. -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.js" type="text/javascript" charset="utf-8"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.12/jquery-ui.js" type="text/javascript" charset="utf-8"></script>

    <!-- The real deal -->
	<script src="js/tag-it.js" type="text/javascript" charset="utf-8"></script>

    <script>

        function getTagItTags(array)
        {
            return $.map(array, function(element) {
                        var key =  typeof element.key != 'undefined' ? element.key : -1;
                        var val = typeof element.value != 'undefined' ? element.value :
                                (typeof element.label != 'undefined'  ? element.label : element);
                        var label = typeof element.label != 'undefined'  ? element.label : val;
                        return {value : val, label : label, key : key};
            });
        }

        function getTagKey($tagit, tag)
        {
            var vn = $tagit.options.valuesNode;
            if (vn){
                var value = $(":first", tag).text();
                var item = $.grep(getTagItTags($tagit.options.availableTags), function(element){
                    return element.value == value;
                });

                return item.length > 0 ? item[0].key : -1;
            }
        }

        function tagitExpellExistent(items, existent)
        {
            return $.grep(items, function(e) {return $.inArray(existent,  e.value);});
        }

        function create_it()
        {
            var sampleTags = [{key : 0, value : 'c++'}, {key : 1, label : 'java'} , {key : 2, value : 'php', label : 'php [2]'} , 'coldfusion', 'javascript', 'asp', 'ruby', 'python', 'c', 'scala', 'groovy', 'haskell', 'perl', 'erlang', 'apl', 'cobol', 'go', 'lua'];

            $('#tagField').tagit({

                maxChars : 5,
                maxCount : 3,
                allowNotInList: true,
                availableTags: sampleTags,
                animate : false,
                valuesNode : $("#tagFieldVlues"),
                tagSource : function(search, showChoices)
                {
                    var that = (this.element).data("tagit");
                    var filter = search.term.toLowerCase();
                    var choices = getTagItTags(that.options.availableTags);
                    choices = $.grep(choices, function(element) {
                        // Only match autocomplete options that begin with the search term.
                        // (Case insensitive.)
                         return (element.value.toLowerCase().indexOf(filter) === 0);
                    });

                    showChoices(tagitExpellExistent(choices, that.assignedTags()));
                },
                onMaxChars: function(widget, input)
                {
                    console.log("onMaxChars");
                },
                onMaxCount: function()
                {
                    console.log("onMaxCount");
                },
                onNotAllowed: function()
                {
                    console.log("onNotAllowed");
                },

                onTagAdded: function(event, tag) {

                    var that = tag.data("tagit");
                    var vn = that.options.valuesNode;

                    if (vn){
                        var value = $(":first", tag).text();
                        var item = $.grep(getTagItTags(that.options.availableTags), function(element){
                            return element.value == value;
                        });

                        var key = item.length > 0 ? item[0].key : -1;

                        vn.val((vn.val() ? vn.val() + "," : "") + key);
                    }
                },

                onTagRemoved: function(event, tag) {

                    var that = tag.data("tagit");
                    var vn = that.options.valuesNode;

                    if (vn){
                        var val = $(":first", tag).text();
                        var values = $(this).val().split(',');
                        var i = values.indexOf(val);
                        var keys = vn.val().split(',');
                        keys.splice(i, 1);
                        vn.val(keys.join(','));
                    }

                }
            });
        }

        function destroy_it()
        {
            $("#tagField").tagit("destroy");
        }
        
        $(document).ready(function(){
            create_it();
        });
    </script>
</head>
<body>
<form>
 <p>
     If you instantiate Tag-it on an INPUT element, it will default to being singleField, with that INPUT element as the singleFieldNode. This is the simplest way to have a gracefully-degrading tag widget.
 </p>
    <input name="tags" id="tagField" value="Apple, Orange" style="width: 300px">
    <input name="tags" id="tagFieldVlues" readonly>

 </form>
<button onclick='destroy_it();'>destroy it!</button>
<button onclick='create_it();'>create it!</button>
</body>
</html>